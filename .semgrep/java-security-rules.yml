rules:

  - id: java.hardcoded-password
    message: "Hardcoded password found — avoid embedding sensitive data."
    severity: ERROR
    patterns:
      - pattern: $VAR = "password"
      - pattern: $VAR = "<SECRET>"
      - pattern: $VAR = /.*(?i:pass).*/
    languages: [java]

  - id: java.sql-injection.statement
    message: "Possible SQL injection — use PreparedStatement instead."
    severity: ERROR
    languages: [java]
    pattern: |
      Statement $S = $C.createStatement();
      $S.executeQuery($QUERY);

  - id: java.sql-injection.concat
    message: "Possible SQL Injection — avoid dynamic SQL concatenation."
    severity: ERROR
    pattern: |
      $STMT = $CONN.prepareStatement("SELECT" + $PART);
    languages: [java]

  - id: java.runtime-exec
    message: "Dangerous use of Runtime.exec — potential command injection."
    severity: ERROR
    languages: [java]
    pattern: |
      Runtime.getRuntime().exec($CMD);

  - id: java.print-stack-trace
    message: "Avoid using printStackTrace() — leaks internals in logs."
    severity: WARNING
    languages: [java]
    pattern: $E.printStackTrace();

  - id: java.weak-crypto-md5
    message: "MD5 is weak — use SHA-256 or higher."
    severity: ERROR
    languages: [java]
    pattern: |
      MessageDigest.getInstance("MD5")

  - id: java.weak-crypto-sha1
    message: "SHA1 is deprecated — use SHA-256 or better."
    severity: ERROR
    languages: [java]
    pattern: |
      MessageDigest.getInstance("SHA1")

  - id: java.insecure-deserialization
    message: "Insecure Java deserialization — can lead to RCE."
    severity: ERROR
    languages: [java]
    pattern: |
      new ObjectInputStream($STREAM)

  - id: java.sensitive-logging
    message: "Avoid logging sensitive information (password, token, email)."
    severity: WARNING
    languages: [java]
    patterns:
      - pattern: LOGGER.info($X)
      - metavariable-pattern:
          metavariable: $X
          pattern: /.*(?i:password|token|secret|credential|email).*/

  - id: java.path-traversal
    message: "Possible Directory Traversal — validate file paths."
    severity: ERROR
    languages: [java]
    pattern: |
      new File($PATH)
